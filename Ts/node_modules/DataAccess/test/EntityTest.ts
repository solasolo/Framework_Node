import { GUID } from 'CommonUtils';

import { PgAccessor, MrAccessor, Entities } from 'DataAccess';

var conObject = {
    host: 'localhost',
    user: 'test',
    password: 'nopassword',
    database: 'Test',
    db: 'Test',
    max: 10,
    idleTimeoutMillis: 30000,
    charset: 'utf8'
};

let dbPg = new PgAccessor(conObject);
let dbMr = new MrAccessor(conObject);

let NewObject: any = {
    ID: GUID.New32(),
    Time: new Date(),
    Value: Math.round(Math.random() * 1000),
    Name: "测试",
    Data: {
        Value: 1024,
        Status: true
    }
};

let entMr = Entities.Define(dbMr, 'test', {
    Default(obj: any) {
        obj.Data.Value = 1000;
    }
});


let entPg = Entities.Define(dbPg, 'Test', {
    Default(obj: any) {
        obj.Data.Value = 1000;
    }
});

entPg.New(NewObject).then((data: any) => {
    console.log(NewObject);
    console.log(data);
}).catch((err: Error) => {
    console.log(err);
});

entMr.New(NewObject).then((data: any) => {
    console.log(NewObject);
    console.log(data);
}).catch((err: Error) => {
    console.log(err);
});