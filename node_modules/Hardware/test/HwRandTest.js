let hd = require('Hardware');
let V8 = require('v8');

console.log(hd);

var Count = 0;

function Test1() {
    let sum = 0;

    if(hd.IsSupported()) {
        for (let i = 0; i < 4096; i++) {
            let r = hd.Read32();
            sum += r;
    
            console.log(r.toString(16));
        }
    
        console.log(hd.IsSupported() + " => " + sum.toString(16));
    
        console.log(hd.ReadBuffer());
        for (let i = 0; i < 33; i++) {
            console.log(hd.ReadBuffer(i));
        }
    } else {
        console.log('Not Support');
    }
}

function Test2() {
    let r = hd.Read32();
    Count++;
    setImmediate(Test2);
}

function ShowHeap() {
    console.log(Count + ":" + V8.getHeapStatistics().used_heap_size);
    setTimeout(ShowHeap, 3000);
}

Test1();
//ShowHeap();